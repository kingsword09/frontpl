export function editorconfigTemplate() {
  return [
    "root = true",
    "",
    "[*]",
    "charset = utf-8",
    "end_of_line = lf",
    "indent_style = space",
    "indent_size = 2",
    "insert_final_newline = true",
    "trim_trailing_whitespace = true",
    "",
    "[*.md]",
    "trim_trailing_whitespace = false",
    "",
  ].join("\n");
}

export function gitignoreTemplate() {
  return ["node_modules", "dist", "coverage", "*.log", ".DS_Store", ".env", ".env.*", ""].join(
    "\n",
  );
}

export function gitattributesTemplate() {
  return ["* text=auto eol=lf", ""].join("\n");
}

export function tsconfigTemplate() {
  return (
    JSON.stringify(
      {
        compilerOptions: {
          target: "ES2022",
          module: "ESNext",
          moduleResolution: "Bundler",
          strict: true,
          skipLibCheck: true,
          noEmit: true,
        },
        include: ["src"],
      },
      null,
      2,
    ) + "\n"
  );
}

export function srcIndexTemplate() {
  return ["export function hello(name: string) {", "  return `Hello, ${name}`;", "}", ""].join(
    "\n",
  );
}

export function srcVitestTemplate() {
  return [
    'import { describe, expect, it } from "vitest";',
    'import { hello } from "./index.js";',
    "",
    'describe("hello", () => {',
    '  it("greets", () => {',
    '    expect(hello("world")).toBe("Hello, world");',
    "  });",
    "});",
    "",
  ].join("\n");
}

export function readmeTemplate(projectName: string) {
  return [`# ${projectName}`, "", "Generated by `frontpl`.", ""].join("\n");
}

export function oxlintConfigTemplate({ useVitest }: { useVitest: boolean }) {
  void useVitest;
  return (
    JSON.stringify(
      {
        $schema: "https://json.schemastore.org/oxlintrc.json",
        env: {
          browser: true,
          es2022: true,
        },
      },
      null,
      2,
    ) + "\n"
  );
}

export function oxfmtConfigTemplate() {
  return (
    JSON.stringify(
      {
        $schema: "https://json.schemastore.org/oxfmtrc.json",
      },
      null,
      2,
    ) + "\n"
  );
}

export function tsdownConfigTemplate() {
  return [
    'import { defineConfig } from "tsdown";',
    "",
    "export default defineConfig({",
    '  entry: ["src/index.ts"],',
    '  platform: "browser"',
    "});",
    "",
  ].join("\n");
}

export function packageJsonTemplate(opts: {
  name: string;
  packageManager: string;
  typescriptVersion: string;
  useOxlint: boolean;
  oxlintVersion?: string;
  oxlintTsgolintVersion?: string;
  useOxfmt: boolean;
  oxfmtVersion?: string;
  useVitest: boolean;
  vitestVersion?: string;
  useTsdown: boolean;
  tsdownVersion?: string;
}) {
  const scripts: Record<string, string> = {
    typecheck: "tsc --noEmit",
  };

  if (opts.useOxlint) {
    const oxlintCmd = [
      "oxlint",
      opts.useVitest ? "--vitest-plugin" : undefined,
      "--type-aware",
      "--type-check",
    ]
      .filter(Boolean)
      .join(" ");
    scripts.lint = oxlintCmd;
    scripts["lint:fix"] = `${oxlintCmd} --fix`;
  }

  if (opts.useOxfmt) {
    scripts.fmt = "oxfmt";
    scripts["fmt:check"] = "oxfmt --check";
  }

  if (opts.useVitest) {
    scripts.test = "vitest";
  }

  if (opts.useTsdown) {
    scripts.build = "tsdown";
  }

  const devDependencies: Record<string, string> = {
    typescript: opts.typescriptVersion,
  };

  if (opts.useOxlint) {
    if (opts.oxlintVersion) devDependencies.oxlint = opts.oxlintVersion;
    if (opts.oxlintTsgolintVersion) devDependencies["oxlint-tsgolint"] = opts.oxlintTsgolintVersion;
  }

  if (opts.useOxfmt && opts.oxfmtVersion) devDependencies.oxfmt = opts.oxfmtVersion;
  if (opts.useVitest && opts.vitestVersion) devDependencies.vitest = opts.vitestVersion;
  if (opts.useTsdown && opts.tsdownVersion) devDependencies.tsdown = opts.tsdownVersion;

  return (
    JSON.stringify(
      {
        name: opts.name,
        version: "0.0.0",
        private: true,
        type: "module",
        scripts,
        devDependencies,
        packageManager: opts.packageManager,
      },
      null,
      2,
    ) + "\n"
  );
}
